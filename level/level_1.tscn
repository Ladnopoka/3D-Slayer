[gd_scene load_steps=16 format=3 uid="uid://ckf3ipmwutb47"]

[ext_resource type="PackedScene" uid="uid://csqg2v0p2s8yw" path="res://player/rogue/rogue_hooded.tscn" id="2_aurua"]
[ext_resource type="PackedScene" uid="uid://dh7eqkenjyvhp" path="res://hideout/hideout.tscn" id="3_uheyo"]
[ext_resource type="PackedScene" uid="uid://dawwbik4sgvk7" path="res://player/barbarian/barbarian.tscn" id="3_wd3uh"]
[ext_resource type="Material" uid="uid://cuinop16et3w1" path="res://assets/resources/grass_material.tres" id="4_vr2du"]
[ext_resource type="PackedScene" uid="uid://ds52ra1i0aaov" path="res://transition/transition.tscn" id="5_1qjme"]
[ext_resource type="PackedScene" uid="uid://dcbt3cxtuaj55" path="res://player/mage/mage.tscn" id="7_kerki"]
[ext_resource type="FontFile" uid="uid://dxh1exxrby0bd" path="res://addons/editor-plugin/fonts/Diablo Heavy.ttf" id="8_f8y4w"]
[ext_resource type="Texture2D" uid="uid://c3ty78dhu6mmv" path="res://assets/panorama/panorama_image.png" id="9_xeoei"]
[ext_resource type="PackedScene" uid="uid://ci7p6fwa6jxd" path="res://portal/portal.tscn" id="10_wksuf"]

[sub_resource type="GDScript" id="GDScript_1jutb"]
script/source = "extends Node3D

@onready var transition = $Transition
@onready var score_max = $Score
@onready var deaths = $Deaths
@onready var mage = $Characters/Mage
#@onready var barbarian = $Characters/Barbarian

var mage_script = load(\"res://player/mage/mage.gd\")

var current_selected_character_name
var selection_area = preload(\"res://player/selection_area.tscn\")

# Called when the node enters the scene tree for the first time. 
func _ready():
	transition.get_node(\"AnimationPlayer\").play(\"fade_in\")
	score_max.text = \"Best Score: \" + str(Global.best_score)
	deaths.text = \"Deaths: \" + str(Global.deaths)
	
	#mage.set_script(null)
	#barbarian.set_script(null)
	#mage.set_script(mage_script)
	
	for character in $Characters.get_children():
		var selection_area_ins = selection_area.instantiate()
		character.add_child(selection_area_ins)
		#print(character.get_children())
		
#func _physics_process(delta):
	#character_selected(\"current_selected_character_name\")
		
func character_selected(character_name):
	current_selected_character_name = character_name
	$CharacterLabel.text = current_selected_character_name
	print(current_selected_character_name)
	for character in $Characters.get_children():
		print(\"Get child count of \", $CharacterLabel.text, \" and it has \", character.get_child_count()-1, \" Childs\")
		print(character.get_children())
		character.get_node(\"SelectionPath\").hide_selection()
		#character.get_child(character.get_child_count()-1).hide_selection()


func _on_button_pressed():
	if current_selected_character_name:
		transition.get_node(\"AnimationPlayer\").play(\"fade_out\")
		await get_tree().create_timer(1).timeout
		GameManager.set_player_character(current_selected_character_name)
		get_tree().change_scene_to_file(\"res://level/level2/level_2.tscn\")
"

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_eycid"]
panorama = ExtResource("9_xeoei")

[sub_resource type="Sky" id="Sky_oax1t"]
sky_material = SubResource("PanoramaSkyMaterial_eycid")

[sub_resource type="Environment" id="Environment_wbfuk"]
background_mode = 2
sky = SubResource("Sky_oax1t")

[sub_resource type="PlaneMesh" id="PlaneMesh_o8vr5"]
material = ExtResource("4_vr2du")

[sub_resource type="BoxShape3D" id="BoxShape3D_lknay"]
size = Vector3(2, 2, 0)

[node name="Level1" type="Node3D"]
script = SubResource("GDScript_1jutb")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_wbfuk")

[node name="Characters" type="Node" parent="."]

[node name="Rogue_Hooded" parent="Characters" instance=ExtResource("2_aurua")]
transform = Transform3D(-0.688582, 0, -0.725158, 0, 1, 0, 0.725158, 0, -0.688582, -6.52419, 0, 4.73239)
script = null

[node name="Skeleton3D" parent="Characters/Rogue_Hooded/Rig" index="0"]
bones/0/position = Vector3(0, 0.000444477, 0)
bones/1/position = Vector3(1.93934e-19, 0.391749, -1.05307e-18)
bones/1/rotation = Quaternion(0.00113227, 0.0426622, 8.96439e-05, 0.999089)
bones/2/rotation = Quaternion(0.00131941, 0.00130558, -0.000127853, 0.999998)
bones/3/rotation = Quaternion(0.000495462, 0.000111325, 5.47964e-05, 1)
bones/4/rotation = Quaternion(-0.559262, -0.0612618, -0.645726, 0.516246)
bones/5/rotation = Quaternion(2.31192e-08, -4.28325e-08, -0.491789, 0.870715)
bones/7/rotation = Quaternion(-0.320513, -0.325352, 0.14419, 0.877854)
bones/8/rotation = Quaternion(0.000247386, 0.000247358, -0.706198, 0.708014)
bones/10/rotation = Quaternion(-0.617731, 0.0811161, 0.619565, 0.47746)
bones/11/rotation = Quaternion(2.72308e-08, 4.81774e-08, 0.51514, 0.857106)
bones/13/rotation = Quaternion(-0.318758, 0.300389, -0.225806, 0.870156)
bones/14/rotation = Quaternion(0.000490094, 0.000577256, 0.706599, 0.707614)
bones/21/position = Vector3(0.170945, 0.113587, 0.001137)
bones/21/rotation = Quaternion(0.993691, 0.0830643, 0.072413, 0.0208501)
bones/22/rotation = Quaternion(0.207149, 6.41557e-08, -1.36296e-07, 0.978309)
bones/23/rotation = Quaternion(-0.523925, -0.206739, 0.0451038, 0.825062)
bones/24/rotation = Quaternion(-3.04834e-08, 0.920355, -0.391084, 6.94798e-08)
bones/25/position = Vector3(-0.170945, 0.113587, -0.00113697)
bones/25/rotation = Quaternion(0.997198, -0.0292782, 0.0310996, 0.0614083)
bones/26/rotation = Quaternion(0.285717, -6.39234e-08, 1.98556e-07, 0.958314)
bones/27/rotation = Quaternion(-0.558885, 0.113207, -0.00872111, 0.821436)
bones/28/rotation = Quaternion(2.98398e-08, 0.920137, -0.391598, -6.93311e-08)
bones/29/position = Vector3(0.170945, 0.292524, 0.576026)
bones/30/position = Vector3(0.20182, 0.0296118, 0.209711)
bones/30/rotation = Quaternion(-0.710195, -7.01274e-08, -7.08987e-08, 0.704005)
bones/36/position = Vector3(-0.170945, 0.292524, 0.576026)
bones/37/position = Vector3(-0.170945, 0.0272452, 0.23756)
bones/37/rotation = Quaternion(-0.699084, -7.13556e-08, -6.96977e-08, 0.71504)
bones/44/position = Vector3(0.520841, 0.786369, -0.0576374)
bones/46/position = Vector3(-0.510844, 0.786369, 0.0597369)

[node name="Knife_Offhand" parent="Characters/Rogue_Hooded/Rig/Skeleton3D" index="0"]
transform = Transform3D(0.000379774, 0.264041, 0.964511, 0.999963, -0.00833211, 0.00188748, 0.00853505, 0.964475, -0.264034, 0.507718, 0.63545, -0.0190058)

[node name="1H_Crossbow" parent="Characters/Rogue_Hooded/Rig/Skeleton3D" index="1"]
transform = Transform3D(0.988658, -0.150181, -3.67414e-05, -0.00112926, -0.00718749, -0.999973, 0.150177, 0.988632, -0.00727594, -0.489359, 0.744071, 0.0978786)

[node name="2H_Crossbow" parent="Characters/Rogue_Hooded/Rig/Skeleton3D" index="2"]
transform = Transform3D(0.988658, -0.150181, -3.67414e-05, -0.00112926, -0.00718749, -0.999973, 0.150177, 0.988632, -0.00727594, -0.489359, 0.744071, 0.0978786)

[node name="Knife" parent="Characters/Rogue_Hooded/Rig/Skeleton3D" index="3"]
transform = Transform3D(3.67456e-05, -0.150181, 0.988658, 0.999973, -0.00718734, -0.00112924, 0.00727579, 0.988632, 0.150177, -0.490919, 0.639372, 0.107358)

[node name="Throwable" parent="Characters/Rogue_Hooded/Rig/Skeleton3D" index="4"]
transform = Transform3D(3.67613e-05, -0.150181, 0.988658, 0.999973, -0.00718733, -0.00112925, 0.00727578, 0.988632, 0.150177, -0.517988, 0.638076, 0.285555)

[node name="Rogue_Cape" parent="Characters/Rogue_Hooded/Rig/Skeleton3D" index="5"]
transform = Transform3D(0.996169, 0.000374962, 0.087451, 0.000140154, 0.999983, -0.00588412, -0.0874517, 0.00587384, 0.996151, 0.000224187, 1.20239, 0.00369345)

[node name="Barbarian" parent="Characters" instance=ExtResource("3_wd3uh")]

[node name="Mage" parent="Characters" instance=ExtResource("7_kerki")]
transform = Transform3D(1, 0, 1.74846e-07, 0, 1, 0, -1.74846e-07, 0, 1, 0, 0, 11)

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.998572, 0.0477985, -0.0238551, -0.0170119, 0.707835, 0.706173, 0.0506395, -0.704759, 0.707637, 0.289022, 8.21207, 0)
shadow_enabled = true

[node name="Floor2" type="StaticBody3D" parent="."]

[node name="Floor" type="MeshInstance3D" parent="Floor2"]
transform = Transform3D(30, 0, 0, 0, 30, 0, 0, 0, 30, 0, 0, 0)
visible = false
mesh = SubResource("PlaneMesh_o8vr5")
skeleton = NodePath("../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Floor2"]
transform = Transform3D(30, 0, 0, 0, -1.31134e-06, 30, 0, -30, -1.31134e-06, 0, 0, 0)
shape = SubResource("BoxShape3D_lknay")

[node name="Portal" parent="." instance=ExtResource("10_wksuf")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6.21744, 0, 16.0452)

[node name="Hideout" parent="." instance=ExtResource("3_uheyo")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)

[node name="Deaths" type="Label" parent="."]
offset_top = 40.0
offset_right = 237.0
offset_bottom = 101.0
theme_override_fonts/font = ExtResource("8_f8y4w")
theme_override_font_sizes/font_size = 50
text = "Deaths:"

[node name="Score" type="Label" parent="."]
offset_right = 526.0
offset_bottom = 61.0
theme_override_fonts/font = ExtResource("8_f8y4w")
theme_override_font_sizes/font_size = 50
text = "Max Score: 10/10"

[node name="Transition" parent="." instance=ExtResource("5_1qjme")]
position = Vector2(1, 0)

[node name="CharacterLabel" type="Label" parent="."]
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -20.0
offset_right = 20.0
offset_bottom = 23.0
grow_horizontal = 2

[node name="Button" type="Button" parent="."]
anchors_preset = 7
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -111.0
offset_top = -79.0
offset_right = 114.0
grow_horizontal = 2
grow_vertical = 0
text = "Select"

[connection signal="pressed" from="Button" to="." method="_on_button_pressed"]

[editable path="Characters/Rogue_Hooded"]
