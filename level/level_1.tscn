[gd_scene load_steps=12 format=3 uid="uid://ckf3ipmwutb47"]

[ext_resource type="PackedScene" uid="uid://csqg2v0p2s8yw" path="res://player/rogue_hooded.tscn" id="2_aurua"]
[ext_resource type="PackedScene" uid="uid://dh7eqkenjyvhp" path="res://hideout/hideout.tscn" id="3_uheyo"]
[ext_resource type="PackedScene" uid="uid://dawwbik4sgvk7" path="res://player/barbarian.tscn" id="3_wd3uh"]
[ext_resource type="Material" uid="uid://cuinop16et3w1" path="res://assets/resources/grass_material.tres" id="4_vr2du"]
[ext_resource type="PackedScene" uid="uid://ds52ra1i0aaov" path="res://transition/transition.tscn" id="5_1qjme"]
[ext_resource type="FontFile" uid="uid://dxh1exxrby0bd" path="res://globals/Diablo Heavy.ttf" id="6_kd8a7"]
[ext_resource type="PackedScene" uid="uid://dcbt3cxtuaj55" path="res://player/mage.tscn" id="7_kerki"]
[ext_resource type="PackedScene" uid="uid://ci7p6fwa6jxd" path="res://portal/portal.tscn" id="10_wksuf"]

[sub_resource type="GDScript" id="GDScript_1jutb"]
script/source = "extends Node3D

@onready var transition = $Transition
@onready var score_max = $Score
@onready var deaths = $Deaths

var current_selected_character_name
var selection_area = preload(\"res://player/selection_area.tscn\")

# Called when the node enters the scene tree for the first time. 
func _ready():
	transition.get_node(\"AnimationPlayer\").play(\"fade_in\")
	score_max.text = \"Best Score: \" + str(Global.best_score)
	deaths.text = \"Deaths: \" + str(Global.deaths)
	
	for character in $Characters.get_children():
		var selection_area_ins = selection_area.instantiate()
		character.add_child(selection_area_ins)
		
func character_selected(character_name):
	current_selected_character_name = character_name
	$CharacterLabel.text = current_selected_character_name
	for character in $Characters.get_children():
		character.get_child(character.get_child_count()-1).hide_selection()


func _on_button_pressed():
	if current_selected_character_name:
		transition.get_node(\"AnimationPlayer\").play(\"fade_out\")
		await get_tree().create_timer(1).timeout
		GameManager.set_player_character(current_selected_character_name)
		get_tree().change_scene_to_file(\"res://level/level2/level_2.tscn\")
"

[sub_resource type="PlaneMesh" id="PlaneMesh_o8vr5"]
material = ExtResource("4_vr2du")

[sub_resource type="BoxShape3D" id="BoxShape3D_lknay"]
size = Vector3(2, 2, 0)

[node name="Level1" type="Node3D"]
script = SubResource("GDScript_1jutb")

[node name="Characters" type="Node" parent="."]

[node name="Mage" parent="Characters" instance=ExtResource("7_kerki")]
transform = Transform3D(1, 0, 1.74846e-07, 0, 1, 0, -1.74846e-07, 0, 1, 0, 0, 11)

[node name="Rogue_Hooded" parent="Characters" instance=ExtResource("2_aurua")]
transform = Transform3D(-0.688582, 0, -0.725158, 0, 1, 0, 0.725158, 0, -0.688582, -6.52419, 0, 4.73239)
script = null

[node name="Skeleton3D" parent="Characters/Rogue_Hooded/Rig" index="0"]
bones/0/position = Vector3(0, 0.000161084, 0)
bones/1/position = Vector3(9.04727e-19, 0.380358, -9.04727e-19)
bones/1/rotation = Quaternion(0.00118163, 0.0426624, 9.17398e-05, 0.999089)
bones/2/rotation = Quaternion(0.00132719, -0.000583441, 2.30852e-05, 0.999999)
bones/3/rotation = Quaternion(0.000505439, 8.08811e-05, -0.000101795, 1)
bones/4/rotation = Quaternion(-0.555722, -0.0579824, -0.638841, 0.52886)
bones/5/rotation = Quaternion(2.85083e-08, -3.81606e-08, -0.509727, 0.860336)
bones/7/rotation = Quaternion(-0.321793, -0.332977, 0.14962, 0.873607)
bones/8/rotation = Quaternion(0.000428684, 0.00042867, -0.705532, 0.708678)
bones/10/rotation = Quaternion(-0.614095, 0.0782074, 0.613939, 0.489745)
bones/11/rotation = Quaternion(1.87276e-08, 6.28076e-08, 0.532342, 0.846529)
bones/13/rotation = Quaternion(-0.320489, 0.308899, -0.231597, 0.865004)
bones/14/rotation = Quaternion(0.00137449, 0.00161895, 0.705679, 0.708528)
bones/21/position = Vector3(0.170945, 0.113587, -0.00106218)
bones/21/rotation = Quaternion(0.991945, 0.0822574, 0.0758916, 0.0593309)
bones/22/rotation = Quaternion(0.325692, 6.08536e-08, -2.22881e-07, 0.945476)
bones/23/rotation = Quaternion(-0.580107, -0.202628, 0.0625466, 0.786451)
bones/24/rotation = Quaternion(-2.97329e-08, 0.919542, -0.392992, 6.93822e-08)
bones/25/position = Vector3(-0.170945, 0.113587, 0.00106221)
bones/25/rotation = Quaternion(0.993652, -0.031119, 0.0303602, 0.103762)
bones/26/rotation = Quaternion(0.375826, -6.08734e-08, 2.62487e-07, 0.92669)
bones/27/rotation = Quaternion(-0.611473, 0.112234, -0.0171536, 0.783077)
bones/28/rotation = Quaternion(3.04805e-08, 0.920355, -0.391084, -6.94881e-08)
bones/29/position = Vector3(0.170945, 0.293115, 0.576617)
bones/30/position = Vector3(0.20182, 0.0267776, 0.198679)
bones/30/rotation = Quaternion(-0.700236, -7.11627e-08, -6.98817e-08, 0.713912)
bones/36/position = Vector3(-0.170945, 0.293115, 0.576617)
bones/37/position = Vector3(-0.170945, 0.0282241, 0.249567)
bones/37/rotation = Quaternion(-0.708165, -7.05227e-08, -7.05663e-08, 0.706047)
bones/44/position = Vector3(0.520841, 0.782269, -0.0576374)
bones/46/position = Vector3(-0.510844, 0.782269, 0.0597369)

[node name="Knife_Offhand" parent="Characters/Rogue_Hooded/Rig/Skeleton3D" index="0"]
transform = Transform3D(0.000368668, 0.260334, 0.965518, 0.999943, -0.0103485, 0.00240882, 0.010619, 0.965463, -0.260324, 0.507498, 0.631593, -0.0158618)

[node name="1H_Crossbow" parent="Characters/Rogue_Hooded/Rig/Skeleton3D" index="1"]
transform = Transform3D(0.987651, -0.156666, 0.000582669, -0.000981391, -0.00990452, -0.99995, 0.156664, 0.987601, -0.0099362, -0.489467, 0.740461, 0.0974778)

[node name="2H_Crossbow" parent="Characters/Rogue_Hooded/Rig/Skeleton3D" index="2"]
transform = Transform3D(0.987651, -0.156666, 0.000582669, -0.000981391, -0.00990452, -0.99995, 0.156664, 0.987601, -0.0099362, -0.489467, 0.740461, 0.0974778)

[node name="Knife" parent="Characters/Rogue_Hooded/Rig/Skeleton3D" index="3"]
transform = Transform3D(-0.000582663, -0.156666, 0.987651, 0.99995, -0.00990438, -0.00098137, 0.00993605, 0.987601, 0.156664, -0.491029, 0.635736, 0.106668)

[node name="Throwable" parent="Characters/Rogue_Hooded/Rig/Skeleton3D" index="4"]
transform = Transform3D(-0.000582647, -0.156666, 0.987651, 0.99995, -0.00990436, -0.000981385, 0.00993603, 0.987601, 0.156664, -0.519267, 0.63395, 0.284679)

[node name="Rogue_Cape" parent="Characters/Rogue_Hooded/Rig/Skeleton3D" index="5"]
transform = Transform3D(0.996497, 0.000380461, 0.0836271, 0.000123315, 0.999982, -0.00601882, -0.0836279, 0.00600805, 0.996479, 0.000111348, 1.19072, 0.00379779)

[node name="Barbarian" parent="Characters" instance=ExtResource("3_wd3uh")]
transform = Transform3D(0.957637, 0, -0.287979, 0, 1, 0, 0.287979, 0, 0.957637, 0.549507, 0, -0.252919)

[node name="Skeleton3D" parent="Characters/Barbarian/Rig" index="0"]
bones/1/position = Vector3(1.05307e-18, 0.380394, -1.05307e-18)
bones/4/rotation = Quaternion(-0.555722, -0.0579824, -0.638841, 0.52886)
bones/5/rotation = Quaternion(2.85083e-08, -3.81606e-08, -0.509727, 0.860336)
bones/7/rotation = Quaternion(-0.321793, -0.332977, 0.14962, 0.873607)
bones/8/rotation = Quaternion(0.000428684, 0.00042867, -0.705532, 0.708678)
bones/11/rotation = Quaternion(-0.614095, 0.0782074, 0.613939, 0.489745)
bones/12/rotation = Quaternion(1.87276e-08, 6.28076e-08, 0.532342, 0.846529)
bones/14/rotation = Quaternion(-0.320489, 0.308899, -0.231597, 0.865004)
bones/15/rotation = Quaternion(0.00137449, 0.00161895, 0.705679, 0.708528)
bones/22/rotation = Quaternion(0.99174, 0.0825019, 0.0756003, 0.0626956)
bones/23/rotation = Quaternion(0.316765, 6.10857e-08, -2.16652e-07, 0.948504)
bones/24/rotation = Quaternion(-0.581593, -0.202538, 0.0629228, 0.785346)
bones/26/rotation = Quaternion(0.994366, -0.0313284, 0.0301594, 0.0966688)
bones/27/rotation = Quaternion(0.376586, -6.08532e-08, 2.62979e-07, 0.926382)
bones/28/rotation = Quaternion(-0.607516, 0.112345, -0.016591, 0.786147)
bones/45/position = Vector3(0.520841, 0.782269, -0.0576374)
bones/47/position = Vector3(-0.510844, 0.782269, 0.0597369)

[node name="1H_Axe_Offhand" parent="Characters/Barbarian/Rig/Skeleton3D" index="0"]
transform = Transform3D(0.000381967, 0.264335, 0.96443, 0.999945, -0.010163, 0.00238969, 0.0104334, 0.964377, -0.264325, 0.51636, 0.631692, 0.0141298)

[node name="Barbarian_Round_Shield" parent="Characters/Barbarian/Rig/Skeleton3D" index="1"]
transform = Transform3D(0.00038176, 0.264335, 0.96443, 0.999945, -0.0101656, 0.00239059, 0.0104361, 0.964377, -0.264325, 0.662393, 0.63223, -0.0427912)

[node name="1H_Axe" parent="Characters/Barbarian/Rig/Skeleton3D" index="2"]
transform = Transform3D(-0.000572272, -0.15257, 0.988292, 0.999951, -0.00972727, -0.000922982, 0.00975445, 0.988244, 0.152568, -0.495544, 0.635841, 0.141593)

[node name="2H_Axe" parent="Characters/Barbarian/Rig/Skeleton3D" index="3"]
transform = Transform3D(-0.000572272, -0.15257, 0.988292, 0.999951, -0.00972727, -0.000922982, 0.00975445, 0.988244, 0.152568, -0.495544, 0.635841, 0.141593)

[node name="Mug" parent="Characters/Barbarian/Rig/Skeleton3D" index="4"]
transform = Transform3D(-0.000572272, -0.15257, 0.988292, 0.999951, -0.00972727, -0.000922982, 0.00975445, 0.988244, 0.152568, -0.487904, 0.335765, 0.0902909)

[node name="Barbarian_Hat" parent="Characters/Barbarian/Rig/Skeleton3D" index="5"]
transform = Transform3D(0.999683, 0.000374566, 0.0251748, -0.00022786, 0.999983, -0.00583013, -0.0251765, 0.00582254, 0.999666, 0.000232892, 1.19114, 0.00365241)

[node name="Barbarian_Cape" parent="Characters/Barbarian/Rig/Skeleton3D" index="6"]
transform = Transform3D(0.996142, 0.000374563, 0.087758, 0.000137864, 0.999983, -0.00583295, -0.0877587, 0.00582254, 0.996125, 0.000230984, 1.19114, 0.00365258)

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.998572, 0.0477985, -0.0238551, -0.0170119, 0.707835, 0.706173, 0.0506395, -0.704759, 0.707637, 0.289022, 8.21207, 0)
shadow_enabled = true

[node name="Floor2" type="StaticBody3D" parent="."]

[node name="Floor" type="MeshInstance3D" parent="Floor2"]
transform = Transform3D(30, 0, 0, 0, 30, 0, 0, 0, 30, 0, 0, 0)
mesh = SubResource("PlaneMesh_o8vr5")
skeleton = NodePath("../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Floor2"]
transform = Transform3D(30, 0, 0, 0, -1.31134e-06, 30, 0, -30, -1.31134e-06, 0, 0, 0)
shape = SubResource("BoxShape3D_lknay")

[node name="Portal" parent="." instance=ExtResource("10_wksuf")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6.21744, 0, 16.0452)

[node name="Hideout" parent="." instance=ExtResource("3_uheyo")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)

[node name="Deaths" type="Label" parent="."]
offset_top = 40.0
offset_right = 237.0
offset_bottom = 101.0
theme_override_fonts/font = ExtResource("6_kd8a7")
theme_override_font_sizes/font_size = 50
text = "Deaths:"

[node name="Score" type="Label" parent="."]
offset_right = 526.0
offset_bottom = 61.0
theme_override_fonts/font = ExtResource("6_kd8a7")
theme_override_font_sizes/font_size = 50
text = "Max Score: 10/10"

[node name="Transition" parent="." instance=ExtResource("5_1qjme")]
position = Vector2(1, 0)

[node name="CharacterLabel" type="Label" parent="."]
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -20.0
offset_right = 20.0
offset_bottom = 23.0
grow_horizontal = 2

[node name="Button" type="Button" parent="."]
anchors_preset = 7
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -111.0
offset_top = -79.0
offset_right = 114.0
grow_horizontal = 2
grow_vertical = 0
text = "Select"

[connection signal="pressed" from="Button" to="." method="_on_button_pressed"]

[editable path="Characters/Rogue_Hooded"]
[editable path="Characters/Barbarian"]
